<div class="layout">
  <!-- Header -->
  <header class="header">
    <div class="title">
      <span class="material-symbols-rounded">radio</span>
      AMQP Lab Dashboard
    </div>

    <div class="status" [class.online]="signalr.$connected()">
      <span class="dot"></span>
      {{ signalr.$connected() ? 'Realtime Connected' : 'Disconnected' }}
    </div>
  </header>

  <!-- Main Grid -->
  <div class="grid">

    <!-- Exchange Panel -->
    <section class="card">
      <h2>Declare Exchange</h2>
      <div class="form">
        <input
          placeholder="Exchange Name"
          [ngModel]="$exchange()"
          (ngModelChange)="setExchange($event)"
        />
        <button (click)="declareExchange()">Declare</button>
      </div>
    </section>

    <!-- Queue Panel -->
    <section class="card">
      <h2>Declare Queue</h2>
      <div class="form">
        <input
          placeholder="Queue Name"
          [ngModel]="$queue()"
          (ngModelChange)="setQueue($event)"
        />
        <button (click)="declareQueue()">Declare</button>
      </div>
    </section>

    <!-- Bind Panel -->
    <section class="card">
      <h2>Bind Queue to Exchange</h2>
      <div class="form">
        <input
          placeholder="Exchange"
          [ngModel]="$exchange()"
          (ngModelChange)="setExchange($event)"
        />
        <input
          placeholder="Queue"
          [ngModel]="$queue()"
          (ngModelChange)="setQueue($event)"
        />
        <input
          placeholder="Routing Key"
          [ngModel]="$routingKey()"
          (ngModelChange)="setRoutingKey($event)"
        />
        <button (click)="bind()">Bind</button>
      </div>
    </section>

    <!-- Publish -->
    <section class="card card-wide">
      <h2>Publish Message</h2>

      <div class="form-row">
        <input
          placeholder="Exchange"
          [ngModel]="$exchange()"
          (ngModelChange)="setExchange($event)"
        />
        <input
          placeholder="Routing Key"
          [ngModel]="$routingKey()"
          (ngModelChange)="setRoutingKey($event)"
        />
      </div>

      <textarea
        placeholder="Message"
        rows="4"
        [ngModel]="$message()"
        (ngModelChange)="setMessage($event)"
      ></textarea>

      <button class="primary" (click)="publish()">Publish</button>
    </section>

    <!-- Consume -->
    <section class="card">
      <h2>Consume Queue</h2>
      <div class="form">
        <input
          placeholder="Queue"
          [ngModel]="$queue()"
          (ngModelChange)="setQueue($event)"
        />
        <button (click)="consume()">Consume</button>
      </div>

      <pre class="code" *ngIf="$consumeResult()">
{{ $consumeResult() | json }}
      </pre>
    </section>

    <!-- Realtime Events -->
    <section class="card card-wide">
      <h2>Realtime Events</h2>

      <div class="realtime-list">
        <div class="event" *ngFor="let m of signalr.$messages()">
          <span class="material-symbols-rounded">flash_on</span>
          <span>{{ m | json }}</span>
        </div>
      </div>
    </section>

    <!-- Logs -->
    <section class="card card-wide">
      <h2>Logs</h2>
      <pre class="logs">
{{ $logs().join('\n') }}
      </pre>
    </section>

  </div>
</div>

